function ajax(url,container_id_or_callback,method,content){if(typeof(container_id_or_callback)=="function"){var objArgs={url:url,method:(method?method:"get"),content:(content?content:null),onLoadObject:container_id_or_callback}}else{var objArgs={url:url,method:(method?method:"get"),content:(content?content:null),target:container_id_or_callback}}TransAjax.exec(objArgs)}function ajax_submit(form_id_or_name_or_obj,container_id_or_callback){var form=null;if(typeof(form_id_or_name_or_obj)=="string"){form=document.forms[form_id_or_name_or_obj];if(!form)form=document.getElementById(form_id_or_name_or_obj);}else{form=form_id_or_name_or_obj}if(!form){alert("Error! Form not found!");return}if(form.action==""){var s=document.location.href;var hash_pos=s.indexOf("#");if(hash_pos>0)s=s.substring(0,hash_pos);form.action=s}if(form.method==""){form.method="get"}var mode="xhr";for(var i=0;i<form.elements.length;i++){if(form.elements[i].type&&form.elements[i].type=="file"){mode="iframe";form.method="post";form.enctype="multipart/form-data";break}}if(mode=="xhr"){var url=form.action;var content=TransAjax.getQueryString(form);if(form.method=="get"){url+=(form.action.indexOf("?")==-1?"?":"")+content;ajax(url,container_id_or_callback,"get")}else{ajax(url,container_id_or_callback,"post",content)}return}if(form.id=="")form.id="frm_"+Math.round(Math.random()*1000);var iid=form.id+"_IFrame";if(typeof(form.iframed)=="undefined"){var e=TransAjax.isIE?'<iframe id="'+iid+'" name="'+iid+'"  onload="parent.ajax_iframe_callback(this.id);">':'IFRAME';var iframe=document.createElement(e);iframe.id=iid;iframe.name=iid;iframe=document.body.appendChild(iframe);if(!TransAjax.isIE)iframe.onload=function(){ajax_iframe_callback(iid)};iframe.style.width="1px";iframe.style.height="1px";iframe.style.overflow="hidden";iframe.style.border="none";iframe._trans_callback=container_id_or_callback;form.iframed=true}form.target=iid;form.submit();TransAjax.showBusyImage()}function ajax_iframe_callback(iid){TransAjax.hideBusyImage();var iframe=document.getElementById(iid);var txt=iframe.contentWindow.document.body.innerHTML;if(!iframe._counter)iframe._counter=0;iframe._counter++;if(typeof(iframe._trans_callback)=="function"){if(txt=='')return;if(TransAjax.detectResponseType(txt)!=TransAjax.IS_UNKNOWN)iframe._trans_callback(TransAjax.result);else iframe._trans_callback({responseText:txt});}else{TransAjax.setInnerHtml(iframe._trans_callback,txt)}}var TransAjax=[];TransAjax.onStart=null;TransAjax.onSend=null;TransAjax.onComplete=null;TransAjax.onStop=null;TransAjax.onError=null;TransAjax.IS_JSON=1;TransAjax.IS_PHP=2;TransAjax.IS_XML=3;TransAjax.IS_UNKNOWN=0;TransAjax.result=null;TransAjax.cache=false;TransAjax.busyImageFile="loading.gif";TransAjax.busyImageVisible=false;TransAjax.busyContainer=false;TransAjax.busyContainerId="busyContainer";TransAjax.counter=0;TransAjax.isIE=/MSIE/.test(navigator.userAgent);TransAjax.exec=function(objArgs){if(arguments.length==2){objArgs={url:arguments[0],target:arguments[1]}}if(objArgs==null||typeof objArgs!='object'){return null}if(!objArgs.url){return null}if(!TransAjax.cache){var rnd='rnd='+Math.random();if(objArgs.url.search(/\?/)!=-1)objArgs.url+='&'+rnd;else objArgs.url+='?'+rnd}if(typeof(objArgs.target)=="string"){objArgs.target=document.getElementById(objArgs.target);if(objArgs.target==null)return alert('Container "'+objArgs.target+'" not found!')}if(!objArgs.target){objArgs.target=null}else{}if(!objArgs.method){objArgs.method='GET'}if(typeof objArgs.async=='undefined'){objArgs.async=true}if(!objArgs.contentType&&objArgs.method.toUpperCase()=='POST'){objArgs.contentType='application/x-www-form-urlencoded'}if(!objArgs.content){objArgs.content=null}if(!objArgs.onLoad){objArgs.onLoad=null}if(!objArgs.onLoadNotify){objArgs.onLoadNotify=null}if(!objArgs.onError){objArgs.onError=null}var objRequest=TransAjax.createRequestObject();if(objRequest==null){return null}if(objArgs.target!=null&&(objArgs.target.tagName=="INPUT"||objArgs.target.tagName=="SELECT")){objArgs.target.disabled="disabled"}var boolErrorDisplayed=false;try{if(TransAjax.onStart&&TransAjax.counter==0)TransAjax.onStart(objArgs);if(typeof objArgs.username!='undefined'&&typeof objArgs.password!='undefined'){objRequest.open(objArgs.method,objArgs.url,objArgs.async,objArgs.username,objArgs.password)}else{objRequest.open(objArgs.method,objArgs.url,objArgs.async)}TransAjax.showBusyImage();var funcOnReady=function(){TransAjax.counter--;if(TransAjax.onComplete)TransAjax.onComplete(objRequest,objArgs);if(TransAjax.onStop&&TransAjax.counter==0)TransAjax.onStop(objRequest,objArgs);TransAjax.hideBusyImage();if(TransAjax.checkRequestStatus(objRequest)){if(objArgs.onLoad){objArgs.onLoad(objRequest.responseText)}else if(objArgs.onLoadObject){switch(TransAjax.detectResponseType(objRequest.responseText)){case TransAjax.IS_JSON:case TransAjax.IS_PHP:case TransAjax.IS_XML:objArgs.onLoadObject(TransAjax.result);break;case TransAjax.IS_UNKNOWN:objArgs.onLoadObject(objRequest)}}else if(objArgs.target){TransAjax.setInnerHtml(objArgs.target,objRequest.responseText);if(objArgs.onLoadNotify){objArgs.onLoadNotify()}}}else if(!boolErrorDisplayed){boolErrorDisplayed=true;if(!objArgs.onError){alert('Error: Cannot fetch '+objArgs.url+'.\n'+(objRequest.statusText||''))}else{objArgs.onError}}};if(objArgs.async){objRequest.onreadystatechange=function(){if(objRequest.readyState==4){funcOnReady();objRequest.onreadystatechange={}}}}if(objArgs.contentType){objRequest.setRequestHeader('Content-Type',objArgs.contentType)}if(TransAjax.onSend)TransAjax.onSend(objArgs);TransAjax.counter++;objRequest.send(objArgs.content);if(!objArgs.async){funcOnReady()}return objRequest}catch(objException){if(!boolErrorDisplayed){boolErrorDisplayed=true;if(objException.name&&objException.name=='NS_ERROR_FILE_NOT_FOUND'){alert('Error: Cannot load '+objArgs.url+'.\nFile not found.');if(objArgs.onError)objArgs.onError}else{alert('Error: Cannot load '+objArgs.url+'.\n'+(objException.message||''));if(objArgs.onError)objArgs.onError}}};return false}TransAjax.busy=function(){return TransAjax.counter>0}TransAjax.detectResponseType=function(txt){TransAjax.result=null;if(txt.substr(0,1)=="{"||txt.substr(0,1)=='['){eval("TransAjax.result = "+txt+";");return TransAjax.IS_JSON}else if(txt.substr(0,2).search(/[aOsidbNorCRU]+:/)!=-1){TransAjax.result=TransAjax.phpUnserialize(txt);return TransAjax.IS_PHP}else if(txt.substr(0,5)=="<?xml"){if(window.DOMParser){try{TransAjax.result=(new DOMParser()).parseFromString(txt,'text/xml');return TransAjax.IS_XML}catch(objException){alert('Error: Cannot parse.\nString does not appear to be a valid XML fragment.:\n'+txt)}}if(typeof ActiveXObject!='undefined'){try{TransAjax.result=new ActiveXObject(TransAjax.XMLActiveX);TransAjax.result.loadXML(objArgs.strXml);return TransAjax.IS_XML}catch(objException){alert('Error: Cannot parse '+objException)}}}return TransAjax.IS_UNKNOWN}TransAjax.setInnerHtml=function(target,html){if(typeof(target)=="string")target=document.getElementById(target);if(target==null)return;if(target.tagName=="INPUT"||target.tagName=="SELECT"){target.disabled=""}if(target.tagName=="INPUT"){var t=target.type;if(t=="text"||t=="password"||t=="hidden"||t=="submit"||t=="button"){target.value=html}}else if(target.tagName=="SELECT"){target.options.length=0;var items=html.split("</option>");for(var i=0;i<items.length;i++){items[i]+='</option>';var r=items[i].match(/<option value="([^"]*)"(.*?)>([^<]*)<\/option>/i);if(r){var val=r[1];var sel=r[2].search(/selected/)!=-1;var txt=r[3];var nOption=document.createElement('OPTION');var nText=document.createTextNode(txt);nOption.setAttribute('value',val);if(sel)nOption.setAttribute('selected','selected');nOption.appendChild(nText);target.appendChild(nOption)}}}else{target.innerHTML=html;TransAjax.evalScripts(html)}}TransAjax.setInnerHTML=TransAjax.setInnerHtml;TransAjax.setBusyContainer=function(obj){if(typeof(obj)=="string")obj=document.getElementById(obj);if(obj){TransAjax.busyContainer=obj;var busyImg=document.createElement("IMG");busyImg.src=TransAjax.busyImageFile;busyImg.style.cssFloat="right";busyImg.style.border="none";busyImg.id="bim_"+Math.floor(Math.random()*900)+100;if(TransAjax.busyContainer.firstChild){TransAjax.busyContainer.insertBefore(busyImg,TransAjax.busyContainer.firstChild)}else{TransAjax.busyContainer.appendChild(busyImg)}}else{TransAjax.busyContainer=false}}TransAjax.showBusyImage=function(){if(TransAjax.busyImageVisible)return;if(!TransAjax.busyContainer)return;TransAjax.busyContainer.style.display="";TransAjax.busyImageVisible=true}TransAjax.hideBusyImage=function(){if(!TransAjax.busyImageVisible)return;if(!TransAjax.busyContainer)return;TransAjax.busyContainer.style.display="none";TransAjax.busyImageVisible=false}TransAjax.createRequestObject=function(){try{if(typeof XMLHttpRequest!='undefined'){obj=new XMLHttpRequest()}else if(typeof ActiveXObject!='undefined'){obj=new ActiveXObject(TransAjax.HTTPActiveX)}if(!obj){alert("Please install new version of browser!");return false}return obj}catch(e){alert(e)}return false}TransAjax.getNameOfActiveX=function(){if(typeof ActiveXObject=='undefined')return'';var v=['Microsoft.XMLHTTP','Msxml2.XMLHTTP.4.0','MSXML2.XMLHTTP.3.0','MSXML2.XMLHTTP'];for(var i=0;i<v.length;i++){try{var objDocument=new ActiveXObject(v[i]);return v[i]}catch(objException){}}return null}TransAjax.getXMLNameOfActiveX=function(){if(typeof ActiveXObject=='undefined')return'';var v=['Msxml2.DOMDocument.4.0','Msxml2.DOMDocument.3.0','MSXML2.DOMDocument','MSXML.DOMDocument','Microsoft.XMLDOM'];for(var i=0;i<v.length;i++){try{var objDocument=new ActiveXObject(v[i]);return v[i]}catch(e){}}return null}TransAjax.checkRequestStatus=function(obj){try{if(obj.readyState==4){if(obj.status==200||obj.status==304||(location.protocol=='file:'&&!obj.status)){return true}}}catch(e){return false};return false}TransAjax.evalScripts=function(s){if(s.search(/<\s*script[^>]*>/)!=-1){var r=s.split(/<\s*\/\s*script\s*>/i);var r2=[];var r3=[];var strScript='';for(var i=0;i<r.length;i++){r2=r[i].match(/<\s*script[^>]+src="([^"]+)"[^>]*>/i)if(r2){var objContainer=document.body;if(!objContainer){objContainer=document.getElementsByTagName('head')[0];if(!objContainer){objContainer=document}}var objScript=document.createElement("SCRIPT");objScript.src=r2[1];objContainer.appendChild(objScript);continue}r3=r[i].split(/<\s*script[^>]*>/i);if(r3.length==2){strScript=r3[1].replace(/function\s+([^(]+)/g,'$1=function');strScript=strScript.replace(/^(\s*<!--|\s*<!\[CDATA\[)/,"");strScript=strScript.replace(/(-->\s*|\]\]>\s*)$/g,"");window.eval(strScript)}}}}TransAjax.serializeForm=function(form_id_or_obj){if(typeof(form_id_or_obj)=="string")form_id_or_obj=document.getElementById(form_id_or_obj);return(form_id_or_obj)?TransAjax.getQueryString(form_id_or_obj):false}TransAjax.getQueryString=function(form_or_obj){if(typeof(form_or_obj)=="string")return form_or_obj;var str="";if(form_or_obj.tagName&&form_or_obj.tagName=="FORM"){var element,i=0;while((element=form_or_obj.elements[i++])!=null){var qc=TransAjax.getQueryComponent(element);if(qc!="")str+="&"+qc}}else{for(i in form_or_obj){str+="&"+TransAjax.urlencode(i)+"="+TransAjax.urlencode(form_or_obj[i])}}return str.substring(1)}TransAjax.getQueryComponent=function(input){if(!input.name||input.disabled)return"";var n=TransAjax.urlencode(input.name);switch(input.type){case"text":case"password":case"submit":case"hidden":return n+"="+TransAjax.urlencode(input.value);case"textarea":var v=input.value.replace(/(\r\n)|\r|\n/g,"\r\n");return n+"="+TransAjax.urlencode(v);case"checkbox":case"radio":if(!input.checked)return"";var v=TransAjax._getElementValue(input);if(v===null)v="on";return n+"="+TransAjax.urlencode(v);case"select-one":case"select-multiple":var nvp=[];var opt,i=0;while((opt=input.options[i++])!=null){if(opt.selected){var v=TransAjax._getElementValue(opt);if(v===null)v=opt.text;nvp[nvp.length]=n+"="+TransAjax.urlencode(v)}}return nvp.join("&");default:return""}}TransAjax.urlencode=function(str){var v;try{v=encodeURIComponent(str)}catch(e){v=escape(str)}return v.replace(/%20/g,"+")}TransAjax._getElementValue=function(input){var attr=input.getAttributeNode("value");return(attr)?input.getAttribute("value"):null}TransAjax.phpSerialize=function(val){switch(typeof(val)){case"number":return(Math.floor(val)==val?"i":"d")+":"+val+";";case"string":return"s:"+val.length+":\""+val+"\";";case"boolean":return"b:"+(val?"1":"0")+";";case"object":if(val==null){return"N;"}else if("length"in val){var idxobj={idx:-1};return"a:"+val.length+":{"+val.map(function(item){this.idx++;var ser=TransAjax.phpSerialize(item);return ser?TransAjax.phpSerialize(this.idx)+ser:false},idxobj).filter(function(item){return item}).join("")+"}"}else{var class_name=TransAjax._getObjectClass(val);if(class_name=="undefined"){return false}var props=new Array();for(var prop in val){var ser=TransAjax.phpSerialize(val[prop]);if(ser){props.push(TransAjax.phpSerialize(prop)+ser)}}return"O:"+class_name.length+":\""+class_name+"\":"+props.length+":{"+props.join("")+"}"}case"undefined":return"N;"}return false}TransAjax.phpUnserialize=function(input){var result=TransAjax._phpUnserialize(input);return result[0]}TransAjax._phpUnserialize=function(input){var length=0;switch(input.charAt(0)){case'a':length=TransAjax._phpUnserialize_GetLength(input);input=input.substr(String(length).length+4);var arr=new Array();var key=null;var value=null;for(var i=0;i<length;++i){key=TransAjax._phpUnserialize(input);input=key[1];value=TransAjax._phpUnserialize(input);input=value[1];if(typeof(key[0])=="number"){arr[key[0]]=value[0]}else{eval("arr."+key[0]+" = '"+value[0]+"';")}}input=input.substr(1);return[arr,input];case'O':length=TransAjax._phpUnserialize_GetLength(input);var classname=String(input.substr(String(length).length+4,length));input=input.substr(String(length).length+6+length);var numProperties=Number(input.substring(0,input.indexOf(':')))input=input.substr(String(numProperties).length+2);var obj=new Object();var property=null;var value=null;for(var i=0;i<numProperties;++i){key=TransAjax._phpUnserialize(input);input=key[1];key[0]=key[0].replace(new RegExp('^\x00'+classname+'\x00'),'');key[0]=key[0].replace(new RegExp('^\x00\\*\x00'),'');value=TransAjax._phpUnserialize(input);input=value[1];obj[key[0]]=value[0]}input=input.substr(1);return[obj,input];case's':length=TransAjax._phpUnserialize_GetLength(input);return[String(input.substr(String(length).length+4,length)),input.substr(String(length).length+6+length)];case'i':case'd':var num=Number(input.substring(2,input.indexOf(';')));return[num,input.substr(String(num).length+3)];case'b':var bool=(input.substr(2,1)==1);return[bool,input.substr(4)];case'N':return[null,input.substr(2)];case'o':case'r':case'C':case'R':case'U':alert('Error: Unsupported PHP data type found!');default:return[null,null]}}TransAjax._phpUnserialize_GetLength=function(input){input=input.substring(2);var length=Number(input.substr(0,input.indexOf(':')));return length}TransAjax._getObjectClass=function(obj){if(obj&&obj.constructor&&obj.constructor.toString){var arr=obj.constructor.toString().match(/function\s*(\w+)/);if(arr&&arr.length==2){return arr[1]}}return undefined}TransAjax.getPath=function(){var objContainer=document.body;if(!objContainer){objContainer=document.getElementsByTagName("head")[0];if(!objContainer)objContainer=document}var objScript=objContainer.lastChild;var path="";var strSrc=objScript.getAttribute("src");if(strSrc){var arrTokens=strSrc.split("/");arrTokens=arrTokens.slice(0,-1);if(arrTokens.length)path=arrTokens.join("/")+"/"}TransAjax.path=path;TransAjax.busyImageFile=(TransAjax.busyImageFile.indexOf("http")==0||TransAjax.busyImageFile.indexOf("/")==0)?TransAjax.busyImageFile:TransAjax.path+TransAjax.busyImageFile;TransAjax._bim=new Image();TransAjax._bim.src=TransAjax.busyImageFile}TransAjax.findBusyContainer=function(){TransAjax.setBusyContainer(TransAjax.busyContainerId)}TransAjax.getPath();TransAjax.HTTPActiveX=TransAjax.getNameOfActiveX();TransAjax.XMLActiveX=TransAjax.getXMLNameOfActiveX();if(window.addEventListener)window.addEventListener("load",TransAjax.findBusyContainer,false);else if(window.attachEvent)window.attachEvent("onload",TransAjax.findBusyContainer);else window.onload=TransAjax.findBusyContainer;